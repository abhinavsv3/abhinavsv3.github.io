---
import BaseLayout from '../layouts/BaseLayout.astro';

// Get all blog posts
const posts = await Astro.glob('./blog/*.{md,mdx}');
const sortedPosts = posts
  .sort((a, b) => new Date(b.frontmatter.pubDate).valueOf() - new Date(a.frontmatter.pubDate).valueOf())
  .slice(0, 5);

const formatDate = (date: string) => {
  return new Date(date).toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'short',
    day: 'numeric',
  });
};
---

<BaseLayout title="Scaling Thoughts">
  <div class="max-w-3xl mx-auto px-6 py-12">
    <!-- Hero Section -->
    <section class="mb-16">
      <h1 class="text-3xl sm:text-4xl font-bold text-gray-900 dark:text-gray-100 mb-6 leading-tight">
        Hi, I'm Abhinav
      </h1>
      <p class="text-xl text-gray-600 dark:text-gray-400 leading-relaxed mb-6">
        I write about technology, software engineering, and building things.
        This is where I share my thoughts and learnings.
      </p>
      <div class="flex gap-4">
        <a href="/about" class="link font-medium">More about me &rarr;</a>
      </div>
    </section>

    <!-- Recent Posts -->
    <section>
      <h2 class="text-2xl font-semibold text-gray-900 dark:text-gray-100 mb-8">
        Recent Writing
      </h2>

      {sortedPosts.length > 0 ? (
        <ul class="space-y-8">
          {sortedPosts.map((post) => (
            <li>
              <a href={post.url} class="group block">
                <article class="flex flex-col sm:flex-row sm:items-baseline gap-2 sm:gap-4">
                  <time
                    datetime={post.frontmatter.pubDate}
                    class="text-sm text-gray-500 dark:text-gray-400 shrink-0 w-28"
                  >
                    {formatDate(post.frontmatter.pubDate)}
                  </time>
                  <div>
                    <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 group-hover:text-accent dark:group-hover:text-accent-dark transition-colors">
                      {post.frontmatter.title}
                    </h3>
                    {post.frontmatter.description && (
                      <p class="text-gray-600 dark:text-gray-400 mt-1">
                        {post.frontmatter.description}
                      </p>
                    )}
                  </div>
                </article>
              </a>
            </li>
          ))}
        </ul>
      ) : (
        <p class="text-gray-500 dark:text-gray-400">
          No posts yet. Check back soon!
        </p>
      )}

      {sortedPosts.length > 0 && (
        <div class="mt-10">
          <a href="/writing" class="link font-medium">
            View all posts &rarr;
          </a>
        </div>
      )}
    </section>
  </div>
</BaseLayout>
